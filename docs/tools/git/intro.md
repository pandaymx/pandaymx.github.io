---
sidebar_position: 1
---

# Git 简介

## 版本控制

在软件开发与文档撰写等工程实践中，对文件内容随时间的演变进行管理至关重要。若无系统性方法，项目管理者通常会采用手动复制文件并重命名的方式（例如 report_v1.0.doc, report_v2.0.doc）来保存不同版本。此种方式极易导致版本混乱，难以精确追踪各项变更，且在多人协作时会引发严重的数据覆盖与冲突问题。

版本控制系统 (Version Control System, VCS) 是一种旨在解决此类问题的软件工程工具。它能够系统化地、自动化地管理文件或项目集合的变更历史，其核心功能包括：

- **变更追踪与记录**：精确记录每一次对文件的修改，包括修改者、时间及具体内容，形成完整的修订历史。
- **历史版本回溯**：允许用户随时查阅项目的任一历史版本，并能将项目恢复至任意指定的时间点状态。
- **差异比较分析**：提供清晰的版本间差异对比功能，便于审查与理解变更内容。
- **协同工作支持**：构建支持多名开发者并行工作的框架，通过合并（Merge）机制有效整合不同成员的贡献，避免相互干扰。
- **分支管理 (Branching)**：允许从主线开发中创建独立的“分支”，用于开发新功能或修复缺陷。分支上的工作在完成并通过验证后，可安全地合并回主干，从而保障主干代码的稳定性。

简而言之，版本控制系统为项目开发提供了一个全面、可靠的变更管理框架，是现代软件工程不可或缺的基础设施。

### 本地版本控制系统

此类系统通常在本地磁盘上维护一个数据库，其中存储着文件历次修订的差异信息（通常称为“补丁”或“delta”）。通过依次应用这些差异信息，系统可以重构出文件在任意时间点的精确状态。其代表性工具是 RCS (Revision Control System)。

**优点：**

- 架构简单，易于理解和使用。
- 所有操作均在本地执行，响应速度快。

**缺点：**

- 协作能力缺失：版本历史仅存于单一计算机，无法直接支持团队协作。
- 数据安全风险高：存在单点故障问题。一旦本地存储介质损坏，所有版本历史将永久丢失。

### 集中式版本控制系统

为克服本地版本控制在协作方面的局限性，集中式版本控制系统应运而生。此类系统设有一台中央服务器，用于统一存储项目的所有版本信息。

所有开发者通过网络连接至该中央服务器。开发者在开始工作前，需从服务器“检出”（Checkout）项目的最新版本。在完成本地修改后，再将变更“提交”（Commit）至中央服务器。著名的 CVCS 包括 Subversion (SVN) 和 CVS。

**优点：**

- 便于团队协作：所有成员均与单一中央仓库交互，使得团队协作流程清晰，管理便捷。
- 权限管理集中：管理员可在服务器端方便地对不同用户的访问权限进行精细化控制。

**缺点：**

- 存在单点故障风险：中央服务器的稳定性和可用性至关重要。若服务器宕机，所有开发者将无法提交代码、对比版本或进行回溯。若服务器数据永久丢失且无备份，项目的全部历史记录将不复存在。
- 对网络连接的强依赖性：绝大多数操作（如提交、更新、查看历史）均需与服务器通信，导致离线状态下可执行的操作非常有限。

### 分布式版本控制系统

分布式版本控制系统是当前的主流范式，它从根本上解决了集中式系统的核心缺陷。

在 DVCS 模型中，每位开发者执行的不再是简单的“检出”，而是将远程服务器上的整个代码仓库（Repository），包括其完整的修订历史，完整地“克隆”（Clone）到本地。因此，每位开发者的本地计算机都持有一份项目的完整镜像和备份。该领域的代表性工具是 Git，此外还有 Mercurial 等。

**优点：**

- 卓越的离线工作支持：由于本地存有完整的版本历史，几乎所有操作（提交、创建分支、查看历史、合并等）均可离线完成，无需网络连接。
- 高可用性与数据安全性：每个克隆的本地仓库都是一个功能完备的备份。即使中央服务器发生故障，任何一个开发者的本地仓库都可用于恢复整个项目。
- 支持多样化的工作流程：其分布式特性天然支持更为复杂和灵活的协作模式，例如功能分支工作流（Feature Branch Workflow）和派生（Forking）工作流。
- 操作响应迅速：核心操作在本地执行，避免了网络延迟，响应速度远超 CVCS。

**缺点：**

- 学习曲线相对陡峭：相较于 CVCS，DVCS 引入了更多概念（如暂存区、远程跟踪分支等），对初学者而言理解成本稍高。
- 初次克隆成本较高：由于需要下载项目的全部历史，对于历史悠久或体积庞大的项目，初次克隆所需的时间和磁盘空间可能多于 CVCS。

### 总结和对比

| 特性         | 本地版本控制 (LVCS) | 集中式版本控制 (CVCS)      | 分布式版本控制 (DVCS)     |
| :----------- | :------------------ | :------------------------- | :------------------------ |
| **仓库结构** | 单用户本地数据库    | 中央服务器统一存储         | 每个开发者持有完整仓库    |
| **核心操作** | check-in, check-out | commit, update             | clone, pull, push, commit |
| **协作能力** | 缺失                | 良好（依赖中央服务）       | 极强且灵活                |
| **离线工作** | 支持（仅限单用户）  | 有限                       | 完全支持                  |
| **数据安全** | 低（存在单点故障）  | 中（中央服务器为单点故障） | 高（分布式备份）          |
| **执行速度** | 迅速                | 较慢（依赖网络）           | 极快（本地操作）          |
| **代表工具** | RCS                 | SVN, CVS                   | Git, Mercurial            |

## Git 详解

### Git 简史

Git 由 林纳斯·托瓦兹 (Linus Torvalds)，即 Linux 内核的创造者，于 2005 年开发。其直接动因是当时 Linux 内核社区使用的商业 DVCS 工具 BitKeeper 停止提供免费授权。面对这一局面，且市面上没有能满足 Linux 内核项目庞大规模和极高效率要求的替代品，林纳斯决定亲自设计并实现一个新的版本控制系统。

- **速度 (Speed)**：将速度作为第一优先级，确保所有常用操作都能瞬时完成。
- **简约设计 (Simple Design)**：基于一个简单而强大的核心数据模型。
- **强大的非线性开发支持 (Strong support for non-linear development)**：能够高效地处理数以千计的并行分支，以适应 Linux 内核的开发模式。
- **完全分布式 (Fully distributed)**：不依赖于任何中央服务器即可进行完整操作。
- **高效处理大型项目 (Capable of handling large projects efficiently)**：在性能和数据完整性上能胜任像 Linux 内核这样的超大型项目。

### 核心特点

- **快照而非差异 (Snapshots, not Differences)**

  与许多将版本历史记录为文件差异（deltas）的 VCS 不同，Git 的核心思想是将数据视为一系列微型文件系统的快照。每次提交（commit）时，Git 都会记录下当时所有文件的完整快照，并保存一个指向该快照的引用。为了提高效率，如果文件未被修改，Git 不会重复存储，而是只保留一个指向上一次已存储文件的链接。

- **内容寻址文件系统 (Content-Addressable Filesystem)**

  Git 的核心是一个简单的键值对数据库。当您向 Git 仓库中添加任何内容时，它会对内容进行校验和（checksum）计算（使用 SHA-1 哈希算法），并将该哈希值作为内容的键（即文件名）。这意味着每一个文件版本、每一个目录结构和每一次提交，都由其内容的哈希值唯一标识。这一机制从根本上保证了数据的完整性（内容无法在不改变其哈希值的情况下被篡改），并使得版本库的复制和合并操作极为高效。

- **暂存区 (Staging Area)**

  这是 Git 最具标志性的功能之一。暂存区是一个位于工作目录和版本库之间的中间区域。它允许开发者在提交之前，精细地选择本次要包含的变更内容。开发者可以将文件的部分修改添加到暂存区，从而构建出逻辑清晰、内容高度相关的“原子性提交”（Atomic Commits），极大地提升了版本历史的可读性和可维护性。

- **保证数据完整性 (Guaranteed Data Integrity)**

  Git 通过加密哈希算法（SHA-1）来确保数据的完整性。仓库中的每一个对象（包括文件内容、目录结构、提交信息等）都通过其内容生成一个唯一的哈希值作为标识。这意味着任何对历史记录的篡改都会被轻易检测到，从而保证了项目历史的真实性和可靠性。

- **卓越的性能与效率 (Superior Performance)**
  由于绝大多数操作都在本地执行，Git 的响应速度极快。无论是提交变更、切换分支还是比较历史版本，几乎都能瞬时完成。即使是面对包含数十万文件和数百万次提交的大型项目，Git 依然能保持高效的性能。

### Git 的工作原理

- **工作目录 (Working Directory)**

  这是您在计算机文件系统中能直接看到和编辑的项目文件树。它是从 Git 仓库（.git 目录）中检出的一个特定版本

- **暂存区 (Staging Area / Index)**

  这是一个位于 .git 目录中的文件，它记录了关于下一次提交内容的快照信息。您可以将工作目录中的修改内容通过 git add 命令选择性地添加到暂存区，为创建一次逻辑清晰的提交做准备。

- **本地仓库 (Local Repository)**

  这就是项目根目录下的 .git 文件夹。它包含了项目所有的元数据和对象数据库，即完整的、所有版本的历史记录。当您执行 git commit 命令时，Git 会将暂存区的内容生成一个永久的快照（一次提交），并将其保存在本地仓库中

## Git 的安装

对于 macOS 和 Linux 用户，Git 通常预装在系统中。您可以通过终端运行 `git --version` 来检查是否已安装。

### Windows（支持 ARM）

Windows 在 2.49 版本后开始支持 ARM 架构。您可以从 Git 官网下载适用于 Windows 的安装包。

下载地址：[Git for Windows](https://git-scm.com/download/win)

运行 .exe 安装文件，对于初学者，建议直接使用默认选项，一路点击 "Next" 即可。

### Linux

**对于 Debian/Ubuntu 系统：**

```bash
sudo apt update
sudo apt install git
```

**对于 Fedora 系统：**

```bash
sudo dnf install git
```

如果您使用的是其他 Linux 发行版，请参考其官方文档获取安装方法。

### macOS

使用 brew 安装：

```bash
brew install git
```

## Git 初始化配置

安装 Git 后，最重要的一件事是设置您的用户名称和电子邮件地址。每一次 Git 提交都会使用这些信息，它们会被永久地嵌入到您创建的提交中。

```sh
# 设置您的用户名
git config --global user.name "Your Name"
# 设置您的邮箱地址
git config --global user.email "youremail@example.com"
```